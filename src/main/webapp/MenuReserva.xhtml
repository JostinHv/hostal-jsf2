<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link rel="preconnect" href="https://fonts.googleapis.com" />
	<link rel="preconnect" href="https://fonts.gstatic.com" />
	<link rel="stylesheet" type="text/css"
		href="#{request.contextPath}/resources/css/style.css" />
	<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css'
		rel='stylesheet' />
	<title>Menu Reservas</title>

	<style type="text/css">
body {
	display: flex;
	justify-content: center;
	align-items: center;
	min-height: 100vh;
	background: hsl(0, 0%, 86.3%);
}
</style>

</h:head>
<h:body>

	<div class="layout-topbar">
		<i class="pi pi-check-square" style="color: #ffffff"></i> <img
			src="#{request.contextPath}/resources/images/logo_uns_final.png"
			alt="Logo" />
		<h1>Menu Reservas</h1>
	</div>

	<div class="crud-demo">
		<h:form id="form">
			<p:growl id="messages" showDetail="true" />

			<p:toolbar class="bar">
				<p:toolbarGroup>
					<p:commandButton value="Agregar" styleClass="ui-button-success"
						icon="pi pi-plus"
						actionListener="#{presentadorMenuReserva.openNew}"
						update=":dialogs:add-product-content"
						oncomplete="PF('addProductDialog').show()">
						<p:resetInput target=":dialogs:add-product-content" />
					</p:commandButton>
				</p:toolbarGroup>
			</p:toolbar>

			<p:dataTable id="dt-products" widgetVar="dtProducts" var="reservaDTO"
				value="#{presentadorMenuReserva.reservas}" reflow="true"
				styleClass="products-table" rowKey="#{reserva.ID}" paginator="true"
				rows="10" paginatorPosition="bottom">

				<p:column headerText="ID Reserva" sortBy="#{reserva.ID}">
					<h:outputText value="#{reservaDTO.ID}" />
				</p:column>
				<p:column headerText="ID Usuario" sortBy="#{reservaDTO.ID_Usuario}">
					<h:outputText value="#{reservaDTO.ID_Usuario}" />
				</p:column>
				<p:column headerText="ID Libro" sortBy="#{reservaDTO.ID_Libro}">
					<h:outputText value="#{reservaDTO.ID_Libro}" />
				</p:column>
				<p:column headerText="Fecha Reserva"
					sortBy="#{reservaDTO.fechaReserva}">
					<h:outputText value="#{reservaDTO.fechaReserva}" />
				</p:column>
				<p:column headerText="Fecha limite"
					sortBy="#{reservaDTO.fechaLimite}">
					<h:outputText value="#{reservaDTO.fechaLimite}" />
				</p:column>
				<p:column headerText="Estado" sortBy="#{reservaDTO.estado}">
					<h:outputText value="#{reservaDTO.estado}" />
				</p:column>
				<p:column class="options" exportable="false">
					<p:commandButton icon="bx bxs-book-open"
						update=":dialogs:consult-product-content"
						oncomplete="PF('consultProductDialog').show()"
						styleClass="edit-button rounded-button ui-button-success"
						style="background-color: hsl(350, 68%, 50%);
							   border: none;
							   outline: none;
							   margin-right:15px;"
						process="@this">
						<f:setPropertyActionListener value="#{reservaDTO}"
							target="#{presentadorMenuReserva.reservaDTO}" />
						<p:resetInput target=":dialogs:consult-product-content" />
					</p:commandButton>
					<p:commandButton class="ui-button-warning rounded-button"
						icon="pi pi-trash" process="@this"
						oncomplete="PF('deleteProductDialog').show()"
						style="color: #f63e28;
							   background-color:#ced4da;
							   border: none;
							   outline: none;">
						<f:setPropertyActionListener value="#{reservaDTO}"
							target="#{presentadorMenuReserva.reservaDTO}" />
					</p:commandButton>
				</p:column>

			</p:dataTable>
		</h:form>

		<h:form id="dialogs">
			<p:dialog header="Añadir Reserva" showEffect="fade" modal="true"
				widgetVar="addProductDialog" responsive="true">
				<p:outputPanel id="add-product-content" class="ui-fluid">
					<p:outputPanel
						rendered="#{not empty presentadorMenuReserva.reservaDTO}">
						<div class="field">
							<p:outputLabel for="idLibroA">ID Libro</p:outputLabel>
							<p:inputText id="idLibroA"
								value="#{presentadorMenuReserva.reservaDTO.ID_Libro}"
								required="true" />
						</div>
					</p:outputPanel>
				</p:outputPanel>

				<f:facet name="footer">
					<p:commandButton value="Reservar" icon="pi pi-check"
						actionListener="#{presentadorMenuReserva.reservar}"
						class="ui-button-save" update="add-product-content"
						process="add-product-content @this" />
					<p:commandButton value="Cancelar" icon="pi pi-times"
						onclick="PF('addProductDialog').hide()"
						class="ui-button-secondary" type="button" />
				</f:facet>
			</p:dialog>
			<p:dialog header="Consultar Reserva" showEffect="fade" modal="true"
				widgetVar="consultProductDialog" responsive="true">
				<p:outputPanel id="consult-product-content" class="ui-fluid">
					<p:outputPanel
						rendered="#{not empty presentadorMenuReserva.reservaDTO}">
						<div class="field">
							<p:outputLabel for="idReserva">ID Reserva: </p:outputLabel>
							<p:outputLabel id="idReserva"
								value="#{presentadorMenuReserva.reservaDTO.ID}" />
						</div>
						<div class="field">
							<p:outputLabel for="idUsuario">ID Usuario: </p:outputLabel>
							<p:outputLabel id="idUsuario"
								value="#{presentadorMenuReserva.reservaDTO.ID_Usuario}" />
						</div>
						<div class="field">
							<p:outputLabel for="idLibro">ID Libro</p:outputLabel>
							<p:outputLabel id="idLibro"
								value="#{presentadorMenuReserva.reservaDTO.ID_Libro}"
								required="true" />
						</div>
						<div class="field">
							<p:outputLabel for="fechaReservaA">Fecha de reserva: </p:outputLabel>
							<p:outputLabel id="fechaReservaA"
								value="#{presentadorMenuReserva.reservaDTO.fechaReserva}"
								required="true" />
						</div>
						<div class="field">
							<p:outputLabel for="fechaVencimiento">Fecha de vencimiento: </p:outputLabel>
							<p:outputLabel id="fechaVencimiento"
								value="#{presentadorMenuReserva.reservaDTO.fechaLimite}"
								required="true" />
						</div>
						<div class="field">
							<p:outputLabel for="estado">Estado: </p:outputLabel>
							<p:outputLabel id="estado"
								value="#{presentadorMenuReserva.reservaDTO.estado}"
								required="true" />
						</div>
					</p:outputPanel>
				</p:outputPanel>

				<f:facet name="footer">
					<p:commandButton value="Cerrar" icon="pi pi-times"
						onclick="PF('consultProductDialog').hide()"
						class="ui-button-secondary" type="button" />
				</f:facet>
			</p:dialog>
			<p:confirmDialog widgetVar="deleteProductDialog" showEffect="fade"
				width="400" message="¿Esta seguro de cancelar la reserva?"
				header="Confirmar" severity="warn">
				<p:commandButton value="Si" icon="pi pi-check"
					actionListener="#{presentadorMenuReserva.cancelar}" process="@this"
					oncomplete="PF('deleteProductDialog').hide()"
					style="background-color: hsl(350, 68%, 50%);
						   border: none;
						   outline: none;" />
				<p:commandButton value="No" type="button"
					styleClass="ui-button-secondary" icon="pi pi-times"
					onclick="PF('deleteProductDialog').hide()" />
			</p:confirmDialog>

			<p:confirmDialog global="true" showEffect="fade" width="300">
				<p:commandButton value="Si" type="button"
					styleClass="ui-confirmdialog-yes" icon="pi pi-check"
					style="background-color: hsl(350, 68%, 50%);
						   border: none;
						   outline: none;" />
				<p:commandButton value="No" type="button"
					styleClass="ui-confirmdialog-no ui-button-secondary"
					icon="pi pi-times" />
			</p:confirmDialog>

			<p:commandButton value="Regresar" class="btn" icon="pi pi-angle-left"
							 style="width: 10%;
									height: 40px;
									background: #fff;
									border: none;
									outline: none;
							     	border-radius: 40px;
									box-shadow: 0 0 10px rgba(0, 0, 0, .1);
									cursor: pointer;
									font-size: 15px;
									color: #333;
									font-weight: 600;
									margin-top: 20px;
									margin-left: -5px;"
				action="#{presentadorMenuReserva.regresarMenu}" ajax="false" />

		</h:form>
	</div>

</h:body>
</html>